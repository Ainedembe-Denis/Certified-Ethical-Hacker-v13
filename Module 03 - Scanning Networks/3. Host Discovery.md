# ğŸ” Host Discovery
### CEH v13 Â· Module 03: Scanning Networks

> **About these notes:** A practical, exam-ready reference on host discovery techniques â€” covering every method, response logic, firewall bypass strategies, and Nmap commands you need for the CEH exam.

---

## ğŸ“‘ Table of Contents

1. [What is Host Discovery?](#1-what-is-host-discovery)
2. [Where It Fits in the CEH Workflow](#2-where-it-fits-in-the-ceh-workflow)
3. [How Nmap Performs Host Discovery](#3-how-nmap-performs-host-discovery)
4. [Technique Overview & Selection Matrix](#4-technique-overview--selection-matrix)
5. [ARP Ping Scan â€” LAN Specialist](#5-arp-ping-scan--lan-specialist)
6. [UDP Ping Scan](#6-udp-ping-scan)
7. [ICMP Echo Ping](#7-icmp-echo-ping)
8. [ICMP Echo Sweep (Ping Sweep)](#8-icmp-echo-sweep-ping-sweep)
9. [ICMP Timestamp Ping](#9-icmp-timestamp-ping)
10. [ICMP Address Mask Ping](#10-icmp-address-mask-ping)
11. [TCP SYN Ping](#11-tcp-syn-ping)
12. [TCP ACK Ping](#12-tcp-ack-ping)
13. [IP Protocol Ping](#13-ip-protocol-ping)
14. [Host Discovery Tools](#14-host-discovery-tools)
15. [Stealth vs. Detectability](#15-stealth-vs-detectability)
16. [CEH Exam Traps & Tips](#16-ceh-exam-traps--tips)

---

## 1. What is Host Discovery?

**Host discovery** is the process of identifying which systems on a target network are **alive** (active and reachable) before performing deeper operations like port scanning, service enumeration, or OS fingerprinting.

> ğŸ§  **Mental Model:**
> Host discovery answers â†’ *"Who is alive?"*
> Everything else in scanning depends on this answer.

### Why It Matters

| Benefit | Explanation |
|---------|-------------|
| **Accurate system status** | Confirms which IPs are active before wasting scan cycles |
| **Identifies reachable hosts** | Separates live targets from dead IP space |
| **Reduces unnecessary traffic** | Eliminates probing of inactive addresses |
| **Saves scanning time** | Focuses effort on confirmed targets |
| **Improves later scan efficiency** | Port scans on live IPs yield cleaner results |
| **Builds a focused target list** | Critical first output of any engagement |

---

## 2. Where It Fits in the CEH Workflow

```
Footprinting (Passive Recon)
         â†“
Host Discovery     â† â˜… FIRST ACTIVE STEP
         â†“
Port & Service Discovery
         â†“
OS Detection
         â†“
Vulnerability Analysis
         â†“
Exploitation
```

> ğŸ“Œ **CEH Exam Favorite:** Host discovery **always precedes** port scanning. This sequence is tested repeatedly.

---

## 3. How Nmap Performs Host Discovery

By default, a plain `nmap <target>` command runs **multiple simultaneous probes**, not just one:

```bash
nmap <target>
```

Default probes Nmap sends concurrently:

| Probe | Purpose |
|-------|---------|
| **ICMP Echo Request** | Standard ping |
| **TCP SYN â†’ port 443** | HTTPS port probe |
| **TCP ACK â†’ port 80** | HTTP port probe |
| **ICMP Timestamp Request** | Fallback when Echo is blocked |

> âš ï¸ **Exam Trap:** Nmap does **NOT** rely on just one probe by default. Specifying a flag like `-PE` restricts it to that single method.

### Skip Host Discovery â€” Treat All Hosts as Online

```bash
nmap -Pn <target>
```

| Use Case | When to Use `-Pn` |
|----------|--------------------|
| Host appears down but you know it's alive | Firewalls silently drop all probe types |
| Scanning a single confirmed IP | Saves the discovery phase |
| Testing firewall evasion | Start port scan regardless of ping response |

> ğŸ’¡ `-Pn` tells Nmap: *"Don't bother checking if the host is up â€” just scan it."*

---

## 4. Technique Overview & Selection Matrix

### All Techniques at a Glance

| Layer | Technique | Nmap Flag | Protocol |
|:-----:|-----------|:---------:|:--------:|
| **L2** | ARP Ping Scan | `-PR` | ARP |
| **L3** | ICMP Echo Ping | `-PE` | ICMP |
| **L3** | ICMP Echo Sweep | *(no extra flag)* | ICMP |
| **L3** | ICMP Timestamp Ping | `-PP` | ICMP |
| **L3** | ICMP Address Mask Ping | `-PM` | ICMP |
| **L3** | UDP Ping | `-PU<port>` | UDP |
| **L3** | TCP SYN Ping | `-PS<port>` | TCP |
| **L3** | TCP ACK Ping | `-PA<port>` | TCP |
| **L3** | IP Protocol Ping | `-PO` | IP |

### ğŸ¯ Technique Selection Matrix â€” HIGH-VALUE FOR EXAMS

| Situation | Best Technique | Why |
|-----------|:--------------:|-----|
| Scanning local LAN | **ARP Ping** | Most accurate at Layer 2; can't be blocked by host firewall |
| ICMP is allowed | **ICMP Echo** | Fast, simple, and reliable |
| ICMP is blocked | **TCP SYN Ping** | Often bypasses perimeter firewalls |
| SYN is also blocked | **TCP ACK Ping** | Bypasses stateful packet filters |
| TCP is filtered | **UDP Ping** | Many firewalls silently pass UDP |
| Heavy multi-layer filtering | **IP Protocol Ping** | Uses uncommon protocol numbers that may slip through |

> ğŸ¯ **CEH Tip:** Exam questions often describe a firewall scenario (e.g., *"ICMP is blocked"*) and ask you to pick the right probe â€” use this matrix.

---

## 5. ARP Ping Scan â€” LAN Specialist

ARP Ping sends **Layer 2 ARP requests** to discover active devices on the local IPv4 range â€” even when restrictive firewalls block all IP-level probes.

> ğŸ’¡ Because ARP operates **below the IP layer**, host-based firewalls cannot block it on the same LAN segment.

### âš™ï¸ How ARP Ping Works

```
Scanner â†’ ARP Request: "Who has 192.168.1.x? Tell me!"
         â†“
Target checks its IP table
         â†“
Live host â†’ ARP Reply: "I have it! My MAC is XX:XX:XX:XX:XX:XX"
         â†“
Scanner marks host as UP âœ…

[No Reply] â†’ Host likely DOWN âŒ
```

### âœ… Why ARP Is Extremely Reliable

| Advantage | Detail |
|-----------|--------|
| **Very efficient and accurate** | Direct Layer 2 communication, no routing overhead |
| **Handles retransmissions** | Nmap automatically resends if no reply |
| **Works on large address spaces** | Scans entire /24 or /16 subnets rapidly |
| **Reveals latency** | Shows round-trip time for each host |
| **Reveals MAC addresses** | Exposes vendor info via OUI lookup |

### ğŸš¨ Critical Limitations

| Limitation | Implication |
|------------|-------------|
| â— LAN-only | ARP requests cannot traverse routers |
| â— No Internet scanning | Only works within the local broadcast domain |
| â— Subnet-bound | Cannot reach hosts on different VLANs without Layer 3 routing |

### ğŸ› ï¸ Nmap Command

```bash
nmap -sn -PR 192.168.1.0/24
```

| Flag | Meaning |
|:----:|---------|
| `-sn` | Skip port scan â€” host discovery only |
| `-PR` | Use ARP ping |

### ğŸ“Š Response Interpretation

| Result | Meaning |
|--------|---------|
| ARP reply received | âœ… Host is **alive** |
| No ARP reply | âŒ Host likely **down** |

> ğŸ“Œ **Examiner Insight:** Nmap automatically uses ARP ping as the **default** method when scanning a local network â€” even without `-PR`. You don't need to specify it explicitly on LAN.

---

## 6. UDP Ping Scan

UDP Ping sends **UDP packets** to a target port and watches for responses. Unlike TCP, UDP is connectionless â€” meaning the response logic differs significantly.

### âš™ï¸ How It Works

```
Scanner â†’ UDP probe packet â†’ Target port

Possible responses:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Response                 â”‚ Interpretation                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ UDP reply                â”‚ Host alive; port open           â”‚
â”‚ ICMP Port Unreachable    â”‚ Host alive; port closed         â”‚
â”‚ No response              â”‚ Port open OR filtered           â”‚
â”‚ ICMP Host Unreachable    â”‚ Host likely down                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ¯ Default Port â€” VERY HIGH-YIELD

> **Default Nmap UDP ping probe port: `40125`**

```bash
nmap -sn -PU40125 <target>
```

| Flag | Meaning |
|:----:|---------|
| `-sn` | Skip port scan |
| `-PU40125` | UDP ping to port 40125 |

> âš ï¸ **Memorize this â€” CEH loves it.** Port `40125` appears in exam questions specifically.

### âœ… Major Advantage

UDP ping can detect hosts **behind strict TCP filtering firewalls** that block all ICMP and TCP probes. Many firewall rules forget to block outbound UDP, leaving a gap.

### âš ï¸ Limitations

| Limitation | Why It Matters |
|------------|----------------|
| **Slower than TCP** | UDP doesn't guarantee delivery â€” retransmissions needed |
| **Unreliable responses** | Silence doesn't definitively mean filtered vs. open |
| **Many systems silently drop UDP** | False negatives are common |

---

## 7. ICMP Echo Ping

The classic **ping** â€” sends an **ICMP Echo Request** and expects an **ICMP Echo Reply** from live hosts.

### âš™ï¸ Response Logic

| Response | Meaning |
|----------|---------|
| **ICMP Echo Reply** | âœ… Host is **alive** |
| **No reply** | âŒ Blocked by firewall **or** host is down |
| **ICMP Unreachable** | Host is reachable but port/service is filtered |

### ğŸ› ï¸ Nmap Command

```bash
nmap -sn -PE <target>
```

| Flag | Meaning |
|:----:|---------|
| `-sn` | Host discovery only |
| `-PE` | ICMP Echo Request |

### âš ï¸ OS Behavior â€” EXAM FAVORITE

| OS | Response to Broadcast ICMP |
|----|---------------------------|
| **UNIX / Linux / BSD** | âœ… Responds to broadcast ICMP |
| **Windows** | âŒ Does **NOT** respond to broadcast ICMP |

> ğŸ“Œ This behavioral difference is a classic CEH question. If a host on LAN doesn't respond to a broadcast ping, it may be Windows â€” not necessarily down.

### âš ï¸ Major Weaknesses

| Weakness | Impact |
|----------|--------|
| Frequently blocked by firewalls | Cannot rely on this alone |
| Easily detected by IDS/IPS | Triggers alerts immediately |
| Windows blocks by default | Introduces false negatives |

---

## 8. ICMP Echo Sweep (Ping Sweep)

A **ping sweep** sends ICMP Echo Requests to an **entire range** of IP addresses to find which ones are alive â€” mapping the "live" IP space of a subnet in one operation.

> ğŸ’¡ Think of it as bulk ICMP Echo Pings across multiple IPs simultaneously.

### ğŸ› ï¸ Nmap Command

```bash
nmap -sn 10.10.1.0/24
```

This scans all 256 IPs in the `10.10.1.0/24` subnet.

### ğŸ“Š Typical Output

```
Nmap scan report for 10.10.1.5
Host is up (0.0021s latency).
Nmap scan report for 10.10.1.12
Host is up (0.0018s latency).
Nmap done: 256 IP addresses (5 hosts up) scanned in 3.12 seconds
```

> ğŸ¯ **CEH Skill:** Recognize the output phrase `"Host is up"` â€” it confirms a successful host discovery response.

### Hping3 Equivalent

```bash
hping3 -1 10.10.1.x --rand-dest -I eth0
```

Sends ICMP Echo to random addresses in a range â€” useful for bypassing sequential-detection IDS rules.

---

## 9. ICMP Timestamp Ping

Instead of an Echo Request, this sends an **ICMP Timestamp Request** â€” asking the target for its current system time.

### ğŸ“Œ Why Use It?

When ICMP Echo (type 8) is **blocked** by a firewall, Timestamp Requests (type 13) may still pass through â€” acting as an alternative host discovery probe.

### ğŸ› ï¸ Nmap Command

```bash
nmap -sn -PP <target>
```

### ğŸ§  Attacker Benefits

| Benefit | Detail |
|---------|--------|
| **Host confirmation** | Any timestap reply proves the host is alive |
| **Uptime estimation** | Timestamp values can reveal how long a host has been running |
| **Firewall bypass** | Some firewalls block Echo but allow Timestamp |

> ğŸ’¡ **Bonus Intel:** By comparing timestamp deltas across multiple probes, an attacker can estimate the **remote machine's uptime** â€” potentially revealing patch cycles or restart schedules.

---

## 10. ICMP Address Mask Ping

Sends an **ICMP Address Mask Request** (type 17) to ask the target for its **subnet mask**.

### ğŸ› ï¸ Nmap Command

```bash
nmap -sn -PM <target>
```

### ğŸ¯ Use Cases

| Use Case | Why It's Useful |
|----------|----------------|
| Host discovery | Any reply confirms host is alive |
| Network mapping | Reveals subnet structure from the target's perspective |
| Subnet reconnaissance | Identifies network boundaries without active port scanning |

> âš ï¸ **Note:** Most modern operating systems and firewalls **disable responses** to ICMP Address Mask Requests by default. This technique is less effective on contemporary systems but remains in the CEH curriculum.

---

## 11. TCP SYN Ping

Sends a **TCP SYN packet** to a specified port â€” **without completing the three-way handshake**. Any response (positive or negative) confirms the host is alive.

### âš™ï¸ Response Logic

| Response | Meaning |
|----------|---------|
| **SYN-ACK returned** | âœ… Host alive; port is **open** |
| **RST returned** | âœ… Host alive; port is **closed** |
| **No response** | âŒ Packet **filtered** by firewall |

> ğŸ’¡ Both SYN-ACK *and* RST confirm the host is alive â€” only silence means filtered.

### ğŸ› ï¸ Nmap Command

```bash
nmap -sn -PS80 <target>
```

Multiple ports:
```bash
nmap -sn -PS22,80,443 <target>
```

| Flag | Meaning |
|:----:|---------|
| `-sn` | Host discovery only |
| `-PS80` | TCP SYN ping to port 80 |

### ğŸ”¥ Why Attackers Love It

| Advantage | Explanation |
|-----------|-------------|
| **ICMP bypass** | Works even when all ICMP is blocked |
| **Speed** | TCP SYN responses are immediate |
| **Relatively stealthy** | No full session established â€” less logging |
| **Firewall-friendly** | Most firewalls allow SYN to common ports (80, 443) |

---

## 12. TCP ACK Ping

Sends an **unsolicited TCP ACK packet** to a target port. This is unusual â€” a legitimate ACK is only sent mid-connection â€” so it reveals a lot about firewall posture.

### âš™ï¸ Response Logic

| Response | Meaning |
|----------|---------|
| **RST returned** | âœ… Host alive; no stateful firewall on this path |
| **No response** | âŒ Packet **filtered** â€” stateful firewall likely present |

> ğŸ§  **Why RST?** A closed port that receives an unexpected ACK responds with RST to reset the invalid connection attempt.

### ğŸ› ï¸ Nmap Command

```bash
nmap -sn -PA80 <target>
```

Multiple ports:
```bash
nmap -sn -PA80,443,8080 <target>
```

### ğŸ¯ Special Advantage â€” Stateful Firewall Testing

| Scenario | What ACK Ping Reveals |
|----------|-----------------------|
| RST received | Path is **unfiltered** â€” no stateful firewall intercepting |
| Silence | **Stateful firewall** is dropping unsolicited ACKs |

> ğŸ“Œ **Key Exam Difference:**
> - **SYN Ping** â†’ used when ICMP is blocked (first fallback)
> - **ACK Ping** â†’ used when SYN is also blocked (second fallback); tests stateful filtering

---

## 13. IP Protocol Ping

Sends packets using **different IP protocol numbers** other than TCP, UDP, or ICMP. It probes for responses to unusual protocol types that firewalls often don't filter.

### ğŸ› ï¸ Nmap Command

```bash
nmap -sn -PO <target>
```

Custom protocols:
```bash
nmap -sn -PO1,2,4 <target>
```

### ğŸ¯ Default Protocol Numbers

| Protocol | Number | Description |
|----------|:------:|-------------|
| **ICMP** | 1 | Internet Control Message Protocol |
| **IGMP** | 2 | Internet Group Management Protocol |
| **IP-in-IP** | 4 | IP encapsulation |

### âš™ï¸ Response Logic

| Response | Meaning |
|----------|---------|
| Any protocol reply | âœ… Host **alive** |
| ICMP Protocol Unreachable | âœ… Host **alive** (protocol not supported) |
| No response | âŒ Filtered or down |

> ğŸ’¡ **When to Use:** Last resort when ICMP, TCP, and UDP are all heavily filtered. Attackers use obscure protocol numbers (e.g., OSPF = 89, SCTP = 132) to find gaps in firewall rule sets.

---

## 14. Host Discovery Tools

### ğŸ§° Primary Tools from the CEH Module

| Tool | Type | Key Strength | Source |
|------|:----:|-------------|--------|
| **Angry IP Scanner** | GUI / CLI | Multithreaded, fast, cross-platform; exports CSV/TXT/XML | [https://angryip.org](https://angryip.org) |
| **NetScanTools Pro** | GUI Suite | Combines ping sweep, DNS, WHOIS in one Windows GUI | [https://www.netscantools.com](https://www.netscantools.com) |
| **SolarWinds Engineer's Toolset** | GUI Suite | Enterprise network monitoring + discovery suite | [https://www.solarwinds.com](https://www.solarwinds.com) |
| **Advanced IP Scanner** | GUI | Fast Windows-based LAN scanner; detects shared folders, RDP | [https://www.advanced-ip-scanner.com](https://www.advanced-ip-scanner.com) |
| **Colasoft Ping Tool** | GUI | Multi-target simultaneous ping with visual graphs | [https://www.colasoft.com](https://www.colasoft.com) |
| **ManageEngine OpUtils** | GUI Suite | Enterprise IP management + ping sweep + network monitoring | [https://www.manageengine.com/products/oputils](https://www.manageengine.com/products/oputils) |

---

### ğŸ”¥ Angry IP Scanner â€” Deep Dive

**Angry IP Scanner** ([angryip.org](https://angryip.org)) is the most commonly referenced host discovery tool in the CEH module beyond Nmap. Key features:

| Feature | Detail |
|---------|--------|
| **Multithreaded scanning** | Scans multiple hosts simultaneously â€” extremely fast |
| **IP range support** | Scan any IPv4 range, CIDR block, or list |
| **Hostname resolution** | Resolves IPs to hostnames via reverse DNS |
| **MAC address detection** | Reveals hardware vendor via OUI lookup |
| **Plugin architecture** | Extend functionality with custom fetchers |
| **Export formats** | CSV, TXT, XML, IP-Port list |
| **Cross-platform** | Works on Windows, Linux, macOS |

```bash
# CLI usage (ipscan CLI version)
ipscan 192.168.1.0/24 -o results.csv
```

---

## 15. Stealth vs. Detectability

Understanding how noisy each technique is helps attackers choose methods that evade IDS/IPS detection.

| Method | Stealth Level | Why |
|--------|:------------:|-----|
| **ARP Ping** | ğŸŸ¢ Very Stealthy | LAN-only; not logged by most IDS (operates below IP) |
| **TCP SYN Ping** | ğŸŸ¡ Moderate | Resembles normal connection attempts; less alarming than sweeps |
| **TCP ACK Ping** | ğŸŸ¡ Moderate | Unusual but isolated; sometimes bypasses detection rules |
| **UDP Ping** | ğŸŸ¡ Moderate | Less scrutinized than ICMP/TCP; depends on firewall ruleset |
| **IP Protocol Ping** | ğŸŸ¡ Moderate | Obscure â€” many IDS signatures don't cover rare protocol types |
| **ICMP Echo** | ğŸ”´ Easily Detected | Most IDS systems alert on ICMP sweeps immediately |
| **Ping Sweep** | ğŸ”´ Very Noisy | Large volume of traffic across many IPs â€” obvious reconnaissance |

> ğŸ’¡ **Attacker Strategy:** Start with ARP (LAN) or TCP SYN pings; avoid raw ICMP sweeps when operating against a monitored network.

---

## 16. CEH Exam Traps & Tips

| âš ï¸ Exam Trap | âœ… Correct Understanding |
|-------------|------------------------|
| **ICMP blocked = host down** | âŒ False â€” try TCP SYN, ACK, or UDP ping instead |
| **ARP works everywhere** | âŒ False â€” ARP works **only on local LAN** segments |
| **Default UDP probe port** | Port **40125** â€” memorize this exact number |
| **Windows responds to broadcast ICMP** | âŒ False â€” Windows ignores broadcast ICMP by default |
| **SYN vs ACK ping** | SYN â†’ used when ICMP blocked; ACK â†’ used when SYN also blocked |
| **Nmap uses one probe by default** | âŒ False â€” Nmap sends multiple probes (ICMP, SYN, ACK, Timestamp) |
| **Port scan before host discovery** | âŒ Wrong order â€” always discover hosts first |
| **Nmap `-Pn` does host discovery** | âŒ False â€” `-Pn` **skips** host discovery and assumes all hosts are up |
| **ICMP Echo is the most reliable** | âŒ False â€” ARP is most reliable (on LAN); Echo is frequently blocked |

---

### ğŸ“‹ Quick Command Reference Card

| Technique | Nmap Command |
|-----------|-------------|
| ARP Ping (LAN) | `nmap -sn -PR 192.168.1.0/24` |
| ICMP Echo Ping | `nmap -sn -PE <target>` |
| ICMP Echo Sweep | `nmap -sn <target>/24` |
| ICMP Timestamp | `nmap -sn -PP <target>` |
| ICMP Address Mask | `nmap -sn -PM <target>` |
| UDP Ping | `nmap -sn -PU40125 <target>` |
| TCP SYN Ping | `nmap -sn -PS80 <target>` |
| TCP ACK Ping | `nmap -sn -PA80 <target>` |
| IP Protocol Ping | `nmap -sn -PO <target>` |
| Skip Discovery | `nmap -Pn <target>` |
| Aggressive (all) | `nmap -sn -PE -PS22,80,443 -PA80 -PU40125 <target>` |

---

*ğŸ“š CEH v13 Â· Module 03: Scanning Networks | Last updated: February 2026*