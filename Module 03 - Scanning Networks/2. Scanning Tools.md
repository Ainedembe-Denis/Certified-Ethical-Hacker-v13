# üîß Scanning Tools
### CEH v13 ¬∑ Module 03: Scanning Networks

> **About these notes:** A practical, exam-ready reference covering the primary network scanning tools used in CEH ‚Äî their capabilities, key commands, response logic, and exam traps.

---

## üìë Table of Contents

1. [Nmap ‚Äî The Core Scanner](#1-nmap--the-core-scanner)
   - [Core Capabilities](#-core-capabilities)
   - [How Nmap Works](#-how-nmap-works)
   - [What Attackers Extract](#-what-attackers-extract-using-nmap)
   - [Essential Nmap Commands](#-essential-nmap-commands)
   - [Host Discovery Methods Compared](#-host-discovery-methods-compared)
2. [Hping3 ‚Äî Packet Crafting Specialist](#2-hping3--packet-crafting-specialist)
   - [When to Use Hping3 vs Nmap](#-when-to-use-hping3-vs-nmap)
   - [Unique Strengths](#-unique-strengths)
   - [Key Hping3 Commands](#-key-hping3-commands)
3. [Metasploit ‚Äî Framework with Scanning Modules](#3-metasploit--framework-with-scanning-modules)
   - [How Metasploit Is Used in Scanning](#-how-metasploit-is-used-in-scanning)
   - [Example Metasploit Commands](#-example-metasploit-commands)
4. [NetScanTools Pro ‚Äî Multi-Function Suite](#4-netscantools-pro--multi-function-suite)
   - [Primary Capabilities](#-primary-capabilities)
   - [Tool Structure](#-tool-structure)
5. [Additional Scanning Tools](#5-additional-scanning-tools)
6. [Tool Sources & References](#6-tool-sources--references)
7. [CEH Exam Tips ‚Äî Scanning Tools](#7-ceh-exam-tips--scanning-tools)

---

## 1. Nmap ‚Äî The Core Scanner

**Nmap** (*Network Mapper*) is an open-source security scanner built for network exploration, host discovery, port scanning, service detection, and OS fingerprinting. It sends specially crafted packets and analyzes responses to build a detailed map of a target network.

> üî• **Nmap is the single most important scanning tool in the CEH exam.** It appears in nearly every scanning scenario.

---

### ‚úÖ Core Capabilities

| Capability | What Nmap Does | Why It Matters |
|------------|---------------|----------------|
| **Host Discovery** | Determines which systems are alive and reachable | First step before port scanning |
| **Port Scanning** | Identifies open, closed, and filtered TCP/UDP ports | Reveals potential entry points |
| **Service Version Detection** | Banner grabbing + version fingerprinting | Enables precise CVE matching |
| **OS Fingerprinting** | Analyzes TCP/IP stack responses to guess OS | Directs OS-specific exploit selection |
| **Firewall / Filter Detection** | Infers filtering from response patterns (or lack thereof) | Helps plan evasion strategies |
| **Ping Sweeps** | Scans entire subnets to find live hosts | Used in early network reconnaissance |
| **Scripting (NSE)** | Runs Lua scripts for advanced tasks (vuln checks, brute force) | Extends Nmap far beyond basic scanning |

---

### üß† How Nmap Works

Nmap operates on a simple **Probe ‚Üí Observe ‚Üí Infer** model:

```
Step 1:  Nmap sends specially crafted packets to the target
              ‚Üì
Step 2:  Target responds ‚Äî or stays silent
              ‚Üì
Step 3:  Nmap analyzes response patterns (flags, timing, TTL, etc.)
              ‚Üì
Step 4:  Nmap infers:
           ‚îú‚îÄ‚îÄ Port state (Open / Closed / Filtered)
           ‚îú‚îÄ‚îÄ OS type and version
           ‚îú‚îÄ‚îÄ Running service and version
           ‚îî‚îÄ‚îÄ Firewall / filter behavior
```

> üìå This entire inference process relies on **TCP/IP stack fingerprinting** ‚Äî each operating system implements TCP slightly differently, and Nmap exploits these differences to identify targets.

---

### üîç What Attackers Extract Using Nmap

A single well-crafted Nmap scan can reveal:

| Data Extracted | Attacker Use |
|---------------|-------------|
| **Live hosts** | Identify which IPs to target |
| **Open ports** | Find potential entry points |
| **Services and versions** | Match against known CVEs |
| **Firewall / filter type** | Plan bypass techniques |
| **MAC address details** | Identify vendor / device type |
| **Operating system and version** | Select OS-specific exploits |

> üí° Together, this output builds the attacker's **target profile** ‚Äî the intelligence needed to move from scanning into exploitation.

---

### üíª Essential Nmap Commands

#### üîπ Basic Scan
```bash
nmap 10.10.1.11
```
- Scans the **top 1,000 most common TCP ports**
- Uses default SYN scan (requires privileges) or TCP Connect scan

> üìå *Exam note:* Often referred to as a "basic TCP scan."

---

#### üîπ Host Discovery Only ‚Äî Ping Sweep
```bash
nmap -sn 10.10.1.0/24
```
- Discovers all **live hosts** in the subnet
- Does **NOT** scan any ports

> üìå Matches the **host discovery stage** of the module. Use this before a full port scan to avoid wasting time on dead IPs.

---

#### üîπ ICMP Echo Ping Scan
```bash
nmap -sn -PE 10.10.1.11
```
| Flag | Meaning |
|:----:|---------|
| `-sn` | Host discovery only ‚Äî skip port scan |
| `-PE` | Use ICMP Echo Request (standard ping) |

> ‚ö†Ô∏è ICMP is frequently blocked by firewalls. Use alternative methods below when it fails.

---

#### üîπ ARP Ping Scan ‚Äî Best for LAN
```bash
nmap -sn -PR 192.168.1.0/24
```
- Uses **ARP requests** instead of IP-level probes
- Extremely **reliable and fast** on local networks
- Cannot be blocked by host-based firewalls on the same LAN segment

---

#### üîπ TCP SYN Ping
```bash
nmap -sn -PS80 10.10.1.11
```
- Sends a TCP `SYN` to port 80; any response (SYN-ACK or RST) confirms the host is alive
- Useful when **ICMP is blocked** by perimeter firewalls

---

#### üîπ TCP ACK Ping
```bash
nmap -sn -PA80 10.10.1.11
```
- Sends a TCP `ACK` to port 80; an RST response confirms the host is alive
- Useful when **SYN packets are blocked** by a stateful firewall (ACK packets may slip through)

---

#### üîπ UDP Ping Scan
```bash
nmap -sn -PU40125 10.10.1.11
```
- Sends a UDP probe to port **40125** (Nmap's default UDP probe port)
- An ICMP Port Unreachable response confirms the host is alive

> üìå **CEH Exam Fact:** The default Nmap UDP ping probe port is **40125**. This specific value appears in exam questions.

---

#### üîπ Service Version Detection
```bash
nmap -sV 10.10.1.11
```
- Performs **banner grabbing** and probes services for version information
- Output example: `80/tcp open http Apache httpd 2.4.49`
- Enables precise CVE and exploit matching

---

#### üîπ OS Detection
```bash
nmap -O 10.10.1.11
```
- Analyzes TCP/IP stack responses to fingerprint the OS
- Requires **root / administrator privileges** to send raw packets

---

#### üîπ Aggressive Scan ‚Äî Exam Favorite
```bash
nmap -A 10.10.1.11
```
Combines four techniques in one command:

| Technique | Flag Equivalent |
|-----------|:--------------:|
| OS Detection | `-O` |
| Service Version Detection | `-sV` |
| NSE Script Scanning | `-sC` |
| Traceroute | `--traceroute` |

> ‚ö†Ô∏è **Warning:** `-A` is very **noisy** ‚Äî it generates significant traffic and is easily detected by IDS/IPS systems. Not stealthy.

---

#### üîπ Fast Comprehensive Scan ‚Äî Automated Workflow
```bash
nmap -T4 -iL scan.txt -oN scan2.txt -v0
```

| Flag | Meaning |
|:----:|---------|
| `-T4` | Aggressive timing (fast scan, more detectable) |
| `-iL scan.txt` | Read target IPs from an input file |
| `-oN scan2.txt` | Save results to a normal text output file |
| `-v0` | Minimal verbosity (quiet output) |

> üìå Demonstrates a typical **automated scanning pipeline** used in penetration testing engagements.

---

### üìä Host Discovery Methods Compared

| Method | Nmap Flag | Protocol | Best Used When |
|--------|:---------:|:--------:|----------------|
| ICMP Echo (Ping) | `-PE` | ICMP | Default; use when ICMP is allowed |
| TCP SYN Ping | `-PS<port>` | TCP | ICMP blocked by perimeter firewall |
| TCP ACK Ping | `-PA<port>` | TCP | SYN also blocked; testing firewall rules |
| UDP Ping | `-PU<port>` | UDP | Both ICMP and TCP filtered |
| ARP Ping | `-PR` | ARP | Scanning local network ‚Äî most reliable on LAN |

---

## 2. Hping3 ‚Äî Packet Crafting Specialist

**Hping3** is a command-line **packet crafting and network probing tool** that supports TCP, UDP, ICMP, and raw IP protocols. Unlike Nmap's automated intelligence, Hping3 gives the attacker full, manual control over every byte of the packet.

> üí° **Nmap vs Hping3 in one sentence:** Nmap *automates* scanning and *interprets* results; Hping3 gives you a *raw socket* and lets you **craft anything you want**.

---

### ‚öñÔ∏è When to Use Hping3 vs Nmap

| Use Case | Better Tool |
|----------|:-----------:|
| Quick port discovery and scanning | **Nmap** |
| OS fingerprinting and service detection | **Nmap** |
| Custom packet flag crafting | **Hping3** |
| Firewall rule testing with specific flags | **Hping3** |
| Covert probing with crafted packets | **Hping3** |
| Bypass filtering with fragmented packets | **Hping3** |
| Remote uptime estimation (timestamp analysis) | **Hping3** |
| Covert channel creation / data tunneling | **Hping3** |

---

### ‚úÖ Unique Strengths

| Capability | How It Works |
|------------|-------------|
| **Custom flag crafting** | Set any combination of TCP flags (SYN, FIN, URG, PSH, etc.) manually |
| **Firewall testing** | Send ACK or FIN packets; observe whether RST returns or it's dropped |
| **Host detection without ICMP** | Use TCP/UDP probes when ICMP is blocked |
| **Remote uptime guessing** | Analyze TCP timestamp option increments to estimate how long a host has been running |
| **Packet fragmentation** | Fragment packets to bypass signature-based IDS rules |
| **Idle host scanning support** | Assist in zombie/idle scan techniques (advanced stealth) |
| **Covert channel creation** | Tunnel arbitrary data inside custom-crafted packet payloads |

---

### üíª Key Hping3 Commands

#### üîπ ICMP Scan
```bash
hping3 -1 10.0.0.25
```
| Flag | Meaning |
|:----:|---------|
| `-1` | ICMP mode ‚Äî sends ICMP Echo Request |

- Functions like a standard `ping` but with more control over packet structure

---

#### üîπ ACK Scan ‚Äî Firewall Probe
```bash
hping3 -A 10.0.0.25 -p 80
```

| Response Received | Inference |
|:-----------------:|----------|
| `RST` returned | Host is **alive**; no stateful firewall on this path |
| No response | Packet is **filtered** ‚Äî stateful firewall likely present |

> üìå This mirrors Nmap's ACK scan logic: RST = unfiltered; silence = filtered.

---

#### üîπ UDP Scan
```bash
hping3 -2 10.0.0.25 -p 80
```

| Response Received | Inference |
|:-----------------:|----------|
| ICMP Port Unreachable | Port is **Closed** |
| No response | Port may be **Open** (or filtered) |

---

#### üîπ SYN Range Scan
```bash
hping3 -8 50-60 -S 10.0.0.25
```
- Scans ports **50 through 60** using SYN packets
- `-8` = scan mode; `-S` = SYN flag

---

#### üîπ FIN / PSH / URG Stealth Scan
```bash
hping3 -F -P -U 10.0.0.25 -p 80
```

| Flag | Meaning |
|:----:|---------|
| `-F` | Set FIN flag |
| `-P` | Set PSH flag |
| `-U` | Set URG flag |

> This is the **Xmas scan** equivalent using Hping3. Targets RFC-compliant systems to infer open ports from silence and closed ports from RST responses.

---

## 3. Metasploit ‚Äî Framework with Scanning Modules

**Metasploit** is an open-source penetration testing framework that automates vulnerability discovery, exploitation, and post-exploitation. In the context of scanning, it provides **auxiliary modules** for port scanning, service detection, and vulnerability validation.

> üí° **Key Advantage ‚Äî Modular Architecture:**
> Any exploit can be combined with any payload. This flexibility makes Metasploit one of the most powerful tools in an attacker's arsenal.

---

### üîß How Metasploit Is Used in Scanning

| Scanning Task | Metasploit Role |
|--------------|----------------|
| Port scanning | Auxiliary scanner modules (TCP, UDP, SYN) |
| Service identification | Version-specific auxiliary modules (SSH, SMB, HTTP) |
| Vulnerability validation | Safe-check modules that confirm exploitability |
| Network pivoting | Route traffic through a compromised host to scan internal networks |
| Reporting | Built-in database (PostgreSQL) to store and query scan results |

---

### üíª Example Metasploit Commands

#### üîπ TCP Port Scan ‚Äî Entire Subnet
```bash
msfconsole
use auxiliary/scanner/portscan/tcp
set RHOSTS 10.10.1.0/24
set PORTS 1-1024
run
```
- Performs a TCP connect scan across the entire `/24` subnet
- Output shows which hosts have open ports within the specified range

---

#### üîπ SSH Version Detection
```bash
use auxiliary/scanner/ssh/ssh_version
set RHOSTS 10.10.1.11
run
```
- Identifies the **exact SSH version** running on port 22
- Output used to match against SSH-specific CVEs

---

#### üîπ SMB Version Detection
```bash
use auxiliary/scanner/smb/smb_version
set RHOSTS 10.10.1.0/24
run
```
- Identifies SMB dialect version across the subnet
- Critical for identifying SMBv1 hosts vulnerable to **EternalBlue (MS17-010)**

---

## 4. NetScanTools Pro ‚Äî Multi-Function Suite

**NetScanTools Pro** is a Windows-based **network investigation and troubleshooting suite** that bundles a wide variety of active and passive network tools into a single graphical interface.

> üí° Think of it as a GUI-based toolkit combining the functionality of dozens of individual command-line tools ‚Äî useful for administrators and investigators who need comprehensive network intelligence without scripting.

---

### ‚úÖ Primary Capabilities

| Capability | Description |
|------------|-------------|
| **LAN Device Discovery** | Identify all devices on the local network segment |
| **Internet Host Discovery** | Probe and enumerate remotely reachable hosts |
| **IP Information Gathering** | Resolve IPs, gather WHOIS, geolocation, ASN data |
| **DNS Enumeration** | Perform DNS lookups, reverse lookups, zone transfers |
| **Port Detection** | Identify exposed TCP/UDP ports on target hosts |
| **Domain Data Collection** | Gather registration, ownership, and DNS records |

---

### üîß Tool Structure

NetScanTools Pro organizes its tools into four categories:

| Category | Examples |
|----------|---------|
| **Active Tools** | Ping, port scanner, traceroute ‚Äî directly probe targets |
| **Passive Tools** | WHOIS, DNS lookups ‚Äî gather data without touching the target |
| **DNS Tools** | Zone transfer, MX/NS lookup, reverse DNS |
| **Local Computer Tools** | Network interface info, ARP table, routing table |

> üëâ This multi-category structure makes NetScanTools Pro a **complete reconnaissance suite** ‚Äî covering both active scanning and passive intelligence gathering in one application.

---

### üéØ How Attackers Benefit

| Attacker Goal | How NetScanTools Pro Helps |
|--------------|--------------------------|
| Map local network | LAN device discovery |
| Identify exposed services | Port detection across ranges |
| Gather domain intelligence | WHOIS, DNS enumeration |
| Build reconnaissance profile | Combines IP, DNS, and service data |

---

## 5. Additional Scanning Tools

Beyond the four primary CEH tools, the module identifies several other notable scanners worth knowing:

| Tool | Type | Key Strength | Source |
|------|:----:|-------------|--------|
| **sx** | CLI Scanner | Extremely fast, stateless ARP/TCP/UDP scanner | [github.com](https://github.com/v-byte-cpu/sx) |
| **RustScan** | CLI Scanner | Ultra-fast port scanner (written in Rust); feeds results into Nmap | [github.com](https://github.com/RustScan/RustScan) |
| **MegaPing** | GUI Scanner | Windows GUI; ping sweep, port scan, NetBIOS scanner all in one | [magnetosoft.com](http://magnetosoft.com) |
| **SolarWinds Engineer's Toolset** | GUI Suite | Enterprise network monitoring + scanning toolkit | [solarwinds.com](https://www.solarwinds.com) |
| **PRTG Network Monitor** | GUI Suite | Continuous network monitoring with alerting and topology maps | [paessler.com](https://www.paessler.com) |

> üìå **Exam Focus:** For CEH, focus on **Nmap**, **Hping3**, **Metasploit**, and **NetScanTools Pro** as the primary tools. The additional tools above are lower-priority but may appear in tool-identification questions.

---

## 6. Tool Sources & References

| Tool | Official Source |
|------|----------------|
| **Nmap** | [nmap.org](https://nmap.org) |
| **Hping3** | [salsa.debian.org](https://salsa.debian.org/debian/hping3) |
| **Metasploit** | [metasploit.com](https://www.metasploit.com) |
| **NetScanTools Pro** | [netscantools.com](https://www.netscantools.com) |
| **sx** | [github.com/v-byte-cpu/sx](https://github.com/v-byte-cpu/sx) |
| **RustScan** | [github.com/RustScan/RustScan](https://github.com/RustScan/RustScan) |
| **MegaPing** | [magnetosoft.com](http://magnetosoft.com) |
| **SolarWinds Engineer's Toolset** | [solarwinds.com](https://www.solarwinds.com) |
| **PRTG Network Monitor** | [paessler.com](https://www.paessler.com) |

---

## 7. CEH Exam Tips ‚Äî Scanning Tools

| ‚ö†Ô∏è Exam Focus Area | ‚úÖ What You Need to Know |
|--------------------|------------------------|
| **Nmap vs Hping3** | Nmap = automated intelligence; Hping3 = manual packet crafting |
| **Default UDP probe port** | Nmap's default UDP ping port is **40125** |
| **Why SYN scan is stealthy** | It never completes the three-way handshake ‚Üí no full session logged |
| **What RST indicates** | RST from target = port is **Closed** (or host is alive in ACK scan) |
| **ACK ping vs SYN ping** | ACK ping used when **SYN is blocked**; both confirm host is alive |
| **Metasploit's key advantage** | **Modular architecture** ‚Äî any exploit + any payload combination |
| **Nmap `-A` flag** | Aggressive scan: OS + version + scripts + traceroute (very noisy) |
| **Nmap `-O` requirement** | OS detection requires **root / administrator privileges** |
| **Silence in stealth scans** | Open port ‚Üí *no response*; Closed port ‚Üí *RST* (FIN/Xmas/NULL scans) |
| **NetScanTools Pro structure** | Four categories: Active, Passive, DNS, Local Computer tools |

---

*üìö CEH v13 ¬∑ Module 03: Scanning Networks | Last updated: February 2026*