# ðŸ›¡ï¸ Network Scanning Concepts
### CEH v13 Â· Module 03: Scanning Networks

> **About these notes:** A comprehensive, exam-ready reference for the core concepts of network scanning. Structured for quick review, deep understanding, and CEH exam success.

---

## ðŸ“‘ Table of Contents

1. [Overview of Network Scanning](#1-overview-of-network-scanning)
   - [Where Scanning Fits in the Hacking Lifecycle](#-where-scanning-fits-in-the-hacking-lifecycle)
   - [Types of Scanning](#-types-of-scanning)
     - [Port Scanning](#-1-port-scanning)
     - [Network Scanning](#-2-network-scanning)
     - [Vulnerability Scanning](#-3-vulnerability-scanning)
   - [Types of Scanning â€” Comparison Table](#-types-of-scanning--at-a-glance-comparison)
2. [Objectives of Network Scanning](#2-objectives-of-network-scanning--exam-critical)
   - [Objective 1 â€“ Discover Live Hosts & Open Ports](#-objective-1--discover-live-hosts-ip-addresses-and-open-ports)
   - [Objective 2 â€“ OS Fingerprinting](#-objective-2--os-and-architecture-fingerprinting)
   - [Objective 3 â€“ Running Services](#-objective-3--discover-runninglistening-services)
   - [Objective 4 â€“ Service Versions](#-objective-4--identify-specific-applications-and-service-versions)
   - [Objective 5 â€“ Identify Vulnerabilities](#-objective-5--identify-vulnerabilities-in-network-systems)
   - [Objective 6 â€“ Map Network Topology](#-objective-6--map-network-topology)
3. [TCP Communication Flags](#3-tcp-communication-flags)
   - [Why TCP Flags Matter](#-why-tcp-flags-matter-in-scanning)
   - [The Six TCP Flags](#-the-six-tcp-flags--in-depth)
     - [SYN](#-syn--synchronize)
     - [ACK](#-ack--acknowledgment)
     - [PSH](#-psh--push)
     - [URG](#-urg--urgent)
     - [FIN](#-fin--finish)
     - [RST](#-rst--reset--)
4. [Quick Reference Summaries](#4-quick-reference-summaries)
   - [TCP Flags at a Glance](#-tcp-flags-at-a-glance)
   - [Three Scanning Types Compared](#-three-scanning-types-compared)
   - [Examiner's Mental Model â€“ Six Key Questions](#-examiners-mental-model--six-key-questions)
5. [CEH Exam Traps & Tips](#5-ceh-exam-traps--tips)

---

## 1. Overview of Network Scanning

Network scanning is a **systematic, active process** used by attackers and defenders alike to gather detailed intelligence about a target network. It is one of the most critical phases of the ethical hacking methodology â€” it transforms abstract information gathered during passive reconnaissance into **actionable attack intelligence**.

> ðŸ’¡ **Analogy:** If *footprinting* is reading a city map from the library, then *scanning* is **walking the streets yourself** â€” knocking on doors, rattling windows, and checking which entrances are unlocked.

---

### ðŸ“ Where Scanning Fits in the Hacking Lifecycle

Understanding scanning's position in the attack chain is vital for the CEH exam.

```
[ Phase 1 ] Reconnaissance (Footprinting)
       â†“  Passive â€” no direct interaction with the target
[ Phase 2 ] Scanning  â—„â”€â”€ YOU ARE HERE
       â†“  Active â€” direct probing of systems
[ Phase 3 ] Enumeration
       â†“  Deeper data extraction (users, shares, policies)
[ Phase 4 ] Vulnerability Analysis
       â†“  Confirm exploitable weaknesses
[ Phase 5 ] Exploitation
       â†“  Gain access
[ Phase 6 ] Post-Exploitation / Maintaining Access
```

> ðŸ“Œ **Exam Insight:** Scanning is **active reconnaissance**. Unlike passive footprinting, it generates traffic that could be logged or detected by IDS/IPS systems.

---

### ðŸ” Types of Scanning

Scanning is broadly categorized into **three main types**. Each serves a distinct purpose in the attack lifecycle.

---

#### ðŸ”¹ 1. Port Scanning

**Definition:** The process of probing a target system's TCP and UDP ports to determine which are open, which services are listening, and which applications are exposed.

**Analogy:** Every port is like a *door or window* on a building. A port scanner walks the perimeter, testing every entrance â€” open, locked, or blocked behind a fence.

**What Port Scanning Reveals:**

| Port Status | What It Means |
|-------------|---------------|
| **Open** | A service is active and actively accepting connections |
| **Closed** | The host is alive, but no service is listening on that port |
| **Filtered** | A firewall or ACL is blocking the probe â€” no response received |
| **Open\|Filtered** | Cannot determine if open or filtered (e.g., UDP) |

**What else you learn from port scanning:**

- The **name of the running service** (e.g., HTTP on port 80)
- Often the **service version** (e.g., Apache 2.4.49)
- **Possible vulnerabilities** associated with that version

> âš ï¸ **Critical CEH Insight:** More open ports generally increase the attack surface â€” but even a system with **very few ports open** can be critically vulnerable if those ports run outdated or misconfigured services.

> ðŸ“Œ **Exam Trap:** Do NOT assume fewer open ports always means a safer system.

---

#### ðŸ”¹ 2. Network Scanning

**Definition:** The process of identifying **active (live) hosts and allocated IP addresses** within a network or subnet. While port scanning focuses on what's *running on* a host, network scanning is about *finding the host itself*.

**Core Questions Answered:**

- Which IP addresses are currently active?
- Which hosts are online and reachable?
- How large is the target network's address space?
- What types of devices exist (routers, servers, workstations, IoT)?

**Who Uses Network Scanning and Why:**

| Actor | Purpose |
|-------|---------|
| **Attacker** | Identify reachable targets for further exploitation |
| **Admin / Blue Team** | Audit inventory, detect unauthorized/rogue devices |
| **Penetration Tester** | Define the scope of assessment, find all in-scope targets |
| **Security Auditor** | Verify that network segmentation is working correctly |

> ðŸ’¡ **CEH Context:** **Host discovery is a sub-step of network scanning.** The typical workflow is: *find live hosts â†’ then port scan those specific hosts*. Running a port scan against an entire subnet is noisy and inefficient.

---

#### ðŸ”¹ 3. Vulnerability Scanning

**Definition:** An automated process of identifying **known security weaknesses** in a target system, including missing patches, misconfigurations, default credentials, and vulnerable software versions.

**Two Core Components of Every Vulnerability Scanner:**

| Component | Role |
|-----------|------|
| **Scanning Engine** | Actively probes systems â€” sends test packets, analyzes responses, attempts safe exploits |
| **Vulnerability Database (Catalog)** | A library of known CVEs, exploit signatures, and vulnerable patterns used to match findings |

**What Vulnerability Scanners Detect:**

- Backup or temporary files left exposed on web servers
- Directory traversal flaws (e.g., `../../../etc/passwd`)
- Missing OS or application security patches
- Default, weak, or empty credentials in use
- Misconfigured services (e.g., anonymous FTP, open SMTP relaying)
- Known vulnerable version matches (e.g., EternalBlue on SMBv1)
- Open administrative interfaces (exposed phpMyAdmin, Jenkins, Kubernetes dashboard)

**How Vulnerabilities Are Typically Remediated:**

- Applying vendor-released security patches promptly
- Hardening service configurations (disabling unnecessary features)
- Removing unneeded services, files, and user accounts
- Enforcing strong authentication and access controls

> ðŸ”¥ **Key Distinction for the Exam:**
>
> | Scan Type | Core Question |
> |-----------|--------------|
> | **Port Scanning** | *Which doors exist and are they open?* |
> | **Vulnerability Scanning** | *Are those doors weak enough to break through?* |

---

### ðŸ“Š Types of Scanning â€” At-a-Glance Comparison

| Attribute | Port Scanning | Network Scanning | Vulnerability Scanning |
|-----------|:------------:|:----------------:|:---------------------:|
| **Primary Focus** | Ports & services | Hosts & IP addresses | Weaknesses & exploits |
| **Key Question** | What's open? | Who's alive? | What's exploitable? |
| **Typical Tools** | Nmap, Masscan | Nmap, Ping Sweep, Angry IP | Nessus, OpenVAS, Qualys |
| **Attack Phase** | Active recon | Active recon | Pre-exploitation |
| **Generates Traffic?** | âœ… Yes | âœ… Yes | âœ… Yes (significant) |
| **Can Trigger IDS?** | âœ… Yes | âœ… Limited | âœ… Yes (very likely) |

---

## 2. Objectives of Network Scanning *(Exam Critical)*

The CEH module defines **six clear objectives** that attackers pursue during scanning. These follow a natural attack progression â€” from discovering hosts all the way to planning exploitation.

> ðŸ§© **Think of it as building a puzzle:** Each objective adds a new piece of information until the attacker has a complete picture of the target environment.

---

### ðŸŽ¯ Objective 1 â€“ Discover Live Hosts, IP Addresses, and Open Ports

**The first and foundational step:** confirm what exists and what is reachable.

**What the attacker learns:**
- Which systems are active and responding to probes
- Which IP addresses are allocated and in use
- Which TCP and UDP ports are open and accessible

**Why it matters:**
> Open ports are **potential entry points**. This initial sweep tells the attacker *where* to focus precious attack time â€” toward the most accessible systems and services.

**Common Host Discovery Methods:**

| Technique | Protocol Used | Notes |
|-----------|:------------:|-------|
| ICMP Echo Request (Ping) | ICMP | Simple but often blocked by firewalls |
| TCP SYN Ping | TCP | Reliable even when ICMP is blocked |
| TCP ACK Ping | TCP | Useful against stateless filtering |
| UDP Ping | UDP | Slow; used for specific UDP-only hosts |
| ARP Scan | ARP | Very fast and reliable on local networks |

> âš ï¸ **Exam Tip:** **ICMP (ping) is frequently blocked** by firewalls and host-based filters. Never assume a "no response to ping" means a host is offline â€” alternative techniques are required.

---

### ðŸŽ¯ Objective 2 â€“ OS and Architecture Fingerprinting

**OS fingerprinting** determines what operating system and architecture a target is running. This is critical because different systems have different vulnerabilities.

**Two Fingerprinting Methods:**

| Method | How It Works | Detectable? |
|--------|-------------|:-----------:|
| **Active Fingerprinting** | Sends specially crafted packets; analyzes TTL values, TCP window sizes, IP ID behavior, and protocol responses | âœ… Yes |
| **Passive Fingerprinting** | Silently observes captured network traffic without generating any probes | âŒ Much harder to detect |

**OS-Specific Clues Fingerprinters Use:**

| Indicator | Typical Windows Value | Typical Linux Value |
|-----------|:--------------------:|:-------------------:|
| Default TTL | 128 | 64 |
| TCP Window Size | 65,535 | 5,840 |
| IP Don't Fragment Bit | Set | Not always set |
| TCP Options Order | Specific pattern | Different pattern |

**Why OS knowledge matters:**

- **Windows systems** may be vulnerable to SMBv1 exploits (EternalBlue / MS17-010)
- **Linux systems** may be vulnerable to Shellshock, Heartbleed, Dirty COW
- **Old mobile OS** versions carry specific privilege escalation exploits

> ðŸ“Œ **Key Tools:** `nmap -O` (OS detection), `Xprobe2`, `p0f` (passive fingerprinting)

---

### ðŸŽ¯ Objective 3 â€“ Discover Running/Listening Services

Beyond confirming a port is **open**, the attacker wants to know **exactly what service** is listening on it and how it's configured.

**Examples of Service Discovery:**

| Port | Potential Service | Why It Matters |
|------|:-----------------:|----------------|
| 22 | SSH | Which version? Key-only or password-based auth? |
| 80 / 443 | HTTP / HTTPS | Apache? IIS? nginx? CMS behind it? |
| 21 | FTP | Anonymous login enabled? |
| 445 | SMB | Which SMB dialect? Is signing enforced? |
| 3389 | RDP | Is NLA enabled? Exposed to internet? |
| 3306 | MySQL | Exposed externally? Root with no password? |

**Why services matter more than ports:**

> Open ports alone tell you *where a door is*. Service enumeration tells you *what kind of lock is on it* â€” and whether it's a cheap deadbolt or a vault door.

**Highest-Risk Services (Frequently Targeted):**

| Service | Port | Primary Risk |
|---------|:----:|-------------|
| FTP | 21 | Plaintext credentials, anonymous login |
| Telnet | 23 | Entirely unencrypted communication |
| SMTP | 25 | Open relay, user enumeration |
| DNS | 53 | Zone transfers (`AXFR`), cache poisoning |
| SMB | 445 | EternalBlue, SMB relay, credential capture |
| RDP | 3389 | Brute-force, BlueKeep (CVE-2019-0708) |
| HTTP/HTTPS | 80/443 | Full web application attack surface |
| Memcached | 11211 | Amplification DDoS, data exposure |

---

### ðŸŽ¯ Objective 4 â€“ Identify Specific Applications and Service Versions

This goes one level deeper than just service type â€” it targets **exact version numbers** of running applications and services.

**Why version-level precision is so powerful:**

Most real-world exploits are **version-specific**. With exact version data, an attacker can skip trial-and-error entirely:

| Known Version | Known Exploit |
|--------------|--------------|
| Apache **2.4.49** | CVE-2021-41773 â€” Path Traversal leading to RCE |
| OpenSSL **1.0.1 â€“ 1.0.1f** | CVE-2014-0160 â€” Heartbleed |
| Windows SMBv1 | MS17-010 â€” EternalBlue (used in WannaCry) |
| Log4j **2.0â€“2.14.1** | CVE-2021-44228 â€” Log4Shell (JNDI injection RCE) |
| PHP **8.1.0-dev** | Backdoor in dev build â€” direct RCE |
| vsFTPd **2.3.4** | Backdoor introduced in compromised source package |

> ðŸ“Œ **Tool:** `nmap -sV` (service and version detection), Netcat banner grabbing, Metasploit auxiliary scanners

> ðŸ’¡ **Insight:** Version detection + a CVE database = a targeted, precision attack. No guessing required.

---

### ðŸŽ¯ Objective 5 â€“ Identify Vulnerabilities in Network Systems

With host, OS, service, and version data collected, the attacker now attempts to confirm **actual, exploitable weaknesses**.

**Vulnerability confirmation checks:**
- Are known CVEs present on the discovered versions?
- Are services misconfigured (e.g., directory listing enabled)?
- Are critical patches missing?
- Are default or weak credentials still in use?
- Are unnecessary admin interfaces publicly accessible?

**The Attacker's Mental Flow:**

```
Discover Host  â†’  Fingerprint OS  â†’  Enumerate Services  â†’  Detect Versions
       â†“
Match Against Known CVEs / Exploit Database
       â†“
Confirm Exploitable Weakness
       â†“
Plan & Execute Attack (Exploitation Phase)
```

> ðŸ”¥ **This is where scanning transitions into exploitation planning.** Vulnerability data directly feeds into the attacker's toolset selection and attack path choice.

---

### ðŸŽ¯ Objective 6 â€“ Map Network Topology

Attackers don't stop at one system â€” they want a **complete picture of the entire environment**:

- Where are the routers, switches, and firewalls?
- Which network segments exist (DMZ, internal LAN, admin)?
- How do systems interconnect â€” which can communicate with which?
- What are the trust relationships between network zones?
- Where are monitoring systems and IDS sensors likely deployed?

**Why Topology Mapping Matters to an Attacker:**

| Purpose | Tactical Benefit |
|---------|-----------------|
| Plan **lateral movement** | Know which systems can reach which other systems |
| Identify **high-value targets** | Domain controllers, databases, backup servers |
| Understand **trust zones** | Find paths from DMZ to internal network |
| **Avoid detection** | Know where sensors / IDS appliances are likely placed |
| Identify **pivot points** | Compromised hosts that bridge network segments |

> ðŸ’¡ **Tools:** `traceroute` / `tracert`, `nmap --traceroute`, Zenmap (visual graph), NetworkMiner, PathPing

---

## 3. TCP Communication Flags

TCP flags are **1-bit control fields** within the TCP header's 6-bit control field. They manage the *state* and *flow* of every TCP connection â€” from the initial handshake to graceful termination and abnormal resets.

> ðŸ’¡ **Big Picture for CEH:** The **entire TCP scanning toolkit** (SYN scan, FIN scan, Xmas scan, NULL scan, ACK scan, etc.) is built entirely on **how different targets respond to specific, crafted TCP flag combinations**. Master the flags â†’ master the scan types.

---

### ðŸ”§ Why TCP Flags Matter in Scanning

Attackers **deliberately manipulate TCP flags** to:

- Determine whether ports are **open, closed, or filtered**
- **Bypass stateless packet filters** that only block specific flag combinations (e.g., SYN)
- Perform **stealth scans** that never complete a full TCP handshake (avoiding connection logs)
- **Fingerprint operating systems** based on how they handle unusual or malformed flag combinations
- **Detect firewalls** by observing which packets get dropped vs. which receive responses

> ðŸ‘‰ **Remember:** Many CEH scan type questions are answered entirely by asking *"What flags were sent?"* and *"What response came back?"*

---

### ðŸš© The Six TCP Flags â€” In Depth

---

#### ðŸ”¹ SYN â€” *Synchronize*

**What it does:**
- Requests the initiation of a new TCP connection
- Synchronizes sequence numbers between two communicating parties

**Normal use â€” The Three-Way Handshake:**

```
Client  â”€â”€â”€â”€ SYN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Server     (Step 1: Request connection)
Client  â—„â”€â”€â”€ SYN-ACK â”€â”€â”€â”€â”€â”€â”€  Server     (Step 2: Server acknowledges + requests)
Client  â”€â”€â”€â”€ ACK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Server     (Step 3: Connection established)
```

**In Scanning â€” The SYN (Half-Open) Scan:**

```
Attacker â”€â”€â”€â”€ SYN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Target
Attacker â—„â”€â”€â”€ SYN-ACK â”€â”€â”€â”€â”€â”€â”€  Target    (Port is OPEN)
Attacker â”€â”€â”€â”€ RST â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º  Target    (Abort â€” never complete the handshake)
```

> The attacker never completes the handshake â†’ **no full connection is logged** â†’ *stealth*.

**Also used in:** SYN flood DoS attacks (sending thousands of SYN packets without completing the handshake, exhausting the server's connection table).

> ðŸ“Œ **If you see SYN in a CEH question â†’ think:** connection initiation / half-open scan / stealth scan.

---

#### ðŸ”¹ ACK â€” *Acknowledgment*

**What it does:**
- Confirms receipt of data segments
- Carries the **next expected sequence number** from the receiver

**Key behavior:**
- Set on virtually **every TCP packet** after the initial SYN
- Combined with SYN in the server's response: `SYN-ACK`

**In Scanning â€” ACK Scan (Firewall Detection):**

> If you send an **unsolicited ACK** (an ACK with no prior connection established), a live RFC-compliant host will reply with **RST** â€” regardless of whether the port is open or closed. However, if a **stateful firewall** is in the way, it will silently **drop** the unexpected ACK packet because it has no matching connection in its state table.

| ACK Sent to... | Response | Inference |
|----------------|---------|----------|
| Unfiltered host | RST | No firewall blocking this path |
| Statefully filtered host | No response | Firewall is present and filtering |

> ðŸ“Œ **Key Rule:** ACK scan = **firewall detection tool**, NOT a port state detection tool.

---

#### ðŸ”¹ PSH â€” *Push*

**What it does:**
- Instructs the receiving system to **immediately flush buffered data** to the application layer
- Prevents data from waiting in TCP receive buffers

**Technical context:**
- Commonly set on the **last segment** of a data stream
- Critical for interactive, real-time applications (SSH sessions, Telnet, chat)
- Prevents buffer deadlocks when small amounts of data are sent infrequently

**In Scanning:**
- PSH rarely appears alone in scanning
- It is **one of three flags set simultaneously** in the **Xmas scan**: `PSH + URG + FIN`
- The combination creates a *"lit-up" packet* that is anomalous and useful against some older firewalls and RFC-compliant systems

> âš ï¸ PSH is not individually significant in CEH scanning scenarios. Remember it as part of **Xmas = PSH + URG + FIN**.

---

#### ðŸ”¹ URG â€” *Urgent*

**What it does:**
- Marks a segment's data as **high-priority / urgent**
- The TCP urgency pointer tells the receiver where urgent data ends in the byte stream
- The receiver processes urgent data **immediately**, out of normal order

**Real-world use:**
- Used in some older protocols for out-of-band signaling
- Rarely seen in modern application traffic

**In Scanning:**
- Like PSH, URG has its main scanning relevance as part of the **Xmas scan** *(PSH + URG + FIN)*
- A packet with URG set in isolation is **anomalous**, making it potentially useful for evasion testing against packet-filtering rules that only look for common flag combinations

> ðŸ“Œ **Exam Appearance:** URG = Xmas scan ingredient. Alone, it is rarely tested.

---

#### ðŸ”¹ FIN â€” *Finish*

**What it does:**
- Signals a **graceful termination** of the sender's side of the connection
- The sender has finished transmitting but can still receive data

**Normal TCP Four-Way Teardown:**

```
Client  â”€â”€â”€â”€ FIN â”€â”€â–º  Server      (I'm done sending)
Client  â—„â”€â”€â”€ ACK â”€â”€â”€  Server      (OK, received)
Client  â—„â”€â”€â”€ FIN â”€â”€â”€  Server      (I'm done too)
Client  â”€â”€â”€â”€ ACK â”€â”€â–º  Server      (Connection fully closed)
```

**In Scanning â€” The FIN Scan:**

The FIN scan exploits a subtle behavioral asymmetry defined in **RFC 793**:

| FIN Packet Sent To... | RFC-Compliant Response | Inference |
|-----------------------|:---------------------:|----------|
| **Closed port** | `RST` â€” the host responds | Port is **Closed** |
| **Open port** | *Silence* â€” the packet is ignored | Port is **Open** |

> ðŸ’¡ **Why FIN Scans Work Against Stateless Filters:**
> Stateless packet filters often only block incoming **SYN** packets from outside the network (to prevent unsolicited connection initiations). A FIN packet *looks like* it belongs to an already-established session, so it slips through â€” and the attacker reads the response.

> **FIN scans do NOT work reliably against Windows systems**, which send RST for both open and closed ports in response to unexpected FIN segments.

---

#### ðŸ”¹ RST â€” *Reset* âš¡

**What it does:**
- **Immediately and abnormally terminates** a connection
- Sent when a TCP segment is received that doesn't match any active connection

**Critical CEH RST Behavior Table:**

| Scenario | What Happens | Inference |
|----------|-------------|----------|
| Packet (FIN/URG/PSH) sent to a **closed port** | Target sends **RST** | Port is **Closed** |
| Packet (FIN/URG/PSH) sent to an **open port** | Target sends **nothing** | Port is **Open** |
| Unsolicited **ACK** received | Target sends **RST** | Host is alive (ACK scan) |
| Attacker sends **RST** after a `SYN-ACK` | Handshake aborted | Stealth scan technique (prevents full session log) |
| RST `+` ACK | Immediate full rejection | Connection refused |

> ðŸ’¡ **The RST vs. No-Response distinction is the foundation of all stealth scanning logic.**
>
> - **Stealth scans** (FIN, Xmas, NULL) infer *open* ports from the **absence of RST**
> - They infer *closed* ports when **RST is received**

> ðŸ“Œ **Single most important rule to memorize:**
> > **Open ports on RFC-compliant systems do NOT respond to unexpected FIN/URG/PSH packets. Closed ports DO respond with RST.**

---

## 4. Quick Reference Summaries

### ðŸš© TCP Flags at a Glance

| Flag | Full Name | Bit Value | Primary Function | Key Scanning Use |
|:----:|-----------|:---------:|-----------------|-----------------|
| **SYN** | Synchronize | 0x02 | Initiate TCP connection | SYN scan (half-open), SYN flood DoS |
| **ACK** | Acknowledgment | 0x10 | Confirm data receipt | ACK scan (firewall detection) |
| **PSH** | Push | 0x08 | Immediate data delivery | Xmas scan (with URG + FIN) |
| **URG** | Urgent | 0x20 | Priority data processing | Xmas scan (with PSH + FIN) |
| **FIN** | Finish | 0x01 | Terminate connection | FIN scan (bypass stateless filters) |
| **RST** | Reset | 0x04 | Abort connection | Indicates closed port; used to abort SYN scans |

---

### ðŸ“Š Three Scanning Types Compared

| Attribute | Port Scanning | Network Scanning | Vulnerability Scanning |
|-----------|:------------:|:----------------:|:---------------------:|
| **Focus** | Ports & services | Hosts & IPs | Weaknesses & exploits |
| **Key Question** | What's open? | Who's alive? | What's exploitable? |
| **Example Tool** | Nmap, Masscan | Nmap, Angry IP Scanner | Nessus, OpenVAS, Qualys |
| **Attack Phase** | Active Recon | Active Recon | Pre-Exploitation |
| **Output Used For** | Service enumeration | Target selection | Exploit selection |

---

### ðŸ§  Examiner's Mental Model â€” Six Key Questions

During scanning, every action the attacker takes answers one of **six fundamental questions**. Trace any CEH scenario back to one of these and you'll identify the correct technique:

| # | The Attacker's Question | Technique Used |
|:-:|------------------------|:-------------:|
| 1 | Which hosts are alive and reachable? | Network / Host Discovery |
| 2 | Which ports are open on those hosts? | Port Scanning |
| 3 | What OS and architecture is running? | OS Fingerprinting |
| 4 | What services are listening? | Service Enumeration |
| 5 | What version of each service is running? | Version Detection (`-sV`) |
| 6 | How is the entire network structured? | Topology Mapping |

> âœ… **Exam Strategy:** In every CEH scanning question, ask which of these 6 questions is being answered. The answer reveals the correct technique and often the correct tool.

---

## 5. CEH Exam Traps & Tips

Watch out for these frequently tested misconceptions:

| âš ï¸ Common Trap | âœ… Correct Understanding |
|----------------|------------------------|
| **Confusing port scanning with vulnerability scanning** | Port scan = *find open doors*; Vulnerability scan = *check if those doors can be broken* |
| **Thinking network scanning reveals services** | Network scanning finds *live hosts*; port scanning finds *services on those hosts* |
| **Assuming ICMP ping always works** | ICMP is frequently **blocked by firewalls** â€” TCP/UDP/ARP-based host discovery may be required |
| **Underestimating OS fingerprinting** | It is a **defined scanning objective**, not just optional extra recon |
| **Ignoring topology mapping** | It is critical for lateral movement planning â€” an attacker needs the full network picture |
| **Assuming fewer open ports = safer** | A single port running a critically vulnerable service is all an attacker needs |
| **Thinking FIN scan works everywhere** | FIN scans **do not work reliably on Windows** â€” Windows responds with RST on both open and closed ports |
| **Thinking ACK scan detects open ports** | ACK scan detects **firewalls**, not port states |
| **Confusing active vs. passive fingerprinting** | Active = sends probes (detectable); Passive = observes traffic (hard to detect) |

---

> ðŸ’¡ **Bonus â€” Common CEH Tools Summary:**
>
> | Tool | Primary Use |
> |------|------------|
> | **Nmap** | Port scanning, OS fingerprinting, service/version detection, scripting |
> | **Masscan** | Ultra-fast port scanning (Internet-scale speed) |
> | **Nessus** | Comprehensive vulnerability scanning |
> | **OpenVAS** | Open-source vulnerability scanner |
> | **Angry IP Scanner** | Fast host/port discovery |
> | **Xprobe2** | Active OS fingerprinting |
> | **p0f** | Passive OS fingerprinting |
> | **Zenmap** | Nmap GUI + visual network topology mapping |
> | **Netcat (nc)** | Manual banner grabbing, raw TCP/UDP connections |
> | **NetworkMiner** | Passive network forensics and topology mapping |

---

*ðŸ“š CEH v13 Â· Module 03: Scanning Networks | Last updated: February 2026*