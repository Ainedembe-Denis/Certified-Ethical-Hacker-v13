# üîç Enumeration Concepts
### CEH v13 ¬∑ Module 04: Enumeration

> **About these notes:** A comprehensive, exam-ready reference for the core concepts of enumeration. Structured for quick review, deep understanding, and CEH exam success, following the methodology of active data extraction.

---

## üìë Table of Contents

1. [Overview of Enumeration](#1-overview-of-enumeration)
   - [What is Enumeration?](#-what-is-enumeration)
   - [Where Enumeration Fits in the Hacking Lifecycle](#-where-enumeration-fits-in-the-hacking-lifecycle)
2. [Information Gathered during Enumeration](#2-information-gathered-during-enumeration)
3. [Techniques for Enumeration](#3-techniques-for-enumeration)
4. [Services and Ports to Enumerate (The "Where")](#4-services-and-ports-to-enumerate-the-where)
5. [SMTP Enumeration Commands](#5-smtp-enumeration-commands)
6. [Deep-Dive: High-Value Targets](#6-deep-dive-high-value-targets)
7. [CEH Exam Traps & Tips](#7-ceh-exam-traps--tips)

---

## 1. Overview of Enumeration

Enumeration is the **first phase of active exploitation**. It involves extracting detailed information from a system or network through active connections and directed queries.

### üìç What is Enumeration?
Enumeration is defined as the process of extracting usernames, machine names, network resources, shares, and services from a target. It transforms scanning results into a list of specific attack vectors.

> üí° **Analogy:** If *scanning* is checking which windows in a house are unlocked, *enumeration* is **opening the window** and looking at the labels on the file folders sitting on the desk inside.

### üìç Where Enumeration Fits in the Hacking Lifecycle
```
[ Phase 1 ] Reconnaissance (Footprinting) ‚Äî Passive
[ Phase 2 ] Scanning ‚Äî Active (Finding live hosts/ports)
[ Phase 3 ] Enumeration  ‚óÑ‚îÄ‚îÄ YOU ARE HERE (Extracting detailed data)
[ Phase 4 ] Vulnerability Analysis ‚Äî (Analyzing weaknesses)
[ Phase 5 ] Exploitation ‚Äî (Gaining access)
```

---

## 2. Information Gathered during Enumeration

- **Network Resources & Shares:** Shared folders (e.g., IPC$ in Windows), printers, and network drives.
- **Users and Groups:** Extracting valid usernames, Relative Identifiers (RID), and group memberships.
- **Routing Tables:** Internal network structure and topology.
- **Audit & Service Settings:** Password policies, account lockout thresholds, and service configurations.
- **Machine Names:** Hostnames and domain roles.
- **Applications and Banners:** Precise version info (FQDN) to match against known CVEs.
- **SNMP & DNS Details:** Device-specific configuration data and zone records.

---

## 3. Techniques for Enumeration

- **Extract usernames using email IDs:** Exploiting the `username@domainname` format.
- **Extract info using default passwords:** Manufacturers often leave `admin/admin` or default community strings (e.g., `public`).
- **Brute force Active Directory:** Exploiting design errors like different error messages for "logon hours" verification to identify valid accounts.
- **DNS Zone Transfer:** Using `nslookup` or `dig` to replicate the entire DNS database from misconfigured name servers.
- **Extract user groups from Windows:** Using the Windows interface or CLI (if the attacker has a low-privilege ID).
- **SNMP Querying:** Guessing community strings to extract user lists and network topology.

---

## 4. Services and Ports to Enumerate (The "Where")

| Service | Port(s) | Protocol | Key Information / Why It Matters |
| :--- | :--- | :--- | :--- |
| **DNS Zone Transfer** | 53 | TCP/UDP | **Critical.** Replicates entire DNS databases. Uses TCP if response exceeds 512 bytes. |
| **Microsoft RPC** | 135 | TCP/UDP | Manages RPC service port mapping. Malformed messages can cause DoS. |
| **NetBIOS Name Svc** | 137 | UDP | Used to match IP addresses with machine names. Usually the first attack point. |
| **NetBIOS Session** | 139 | TCP | **High Priority.** Used for file/printer sharing and **Null Session** establishment. |
| **SMB over TCP** | 445 | TCP/UDP | Modern replacement for NBT (NetBIOS over TCP). used for direct file sharing. |
| **SNMP** | 161 (Manager) | UDP | Agent receives requests on 161. Extracts device topology and users. |
| **SNMP Trap** | 162 | TCP/UDP | Agent sends notifications/traps to the manager (e.g., sysUpTime). |
| **LDAP** | 389 | TCP/UDP | Protocol for accessing Active Directory directory information. |
| **Global Catalog** | 3268 | TCP/UDP | AD domain controller storing organization-wide object rows (without knowing domain). |
| **ISAKMP/IKE** | 500 | UDP | Used in IPSec/VPNs to establish security associations (SAs). |
| **SMTP** | 25 | TCP | Mail delivery; reveals software version and internal usernames. |
| **NFS** | 2049 | TCP | Mounts remote file systems. Misconfiguration allows remote control/priv escalation. |
| **SSH / SFTP** | 22 | TCP | Secure management. Attacked via brute-force or banner grabbing version info. |
| **SIP (VoIP)** | 5060, 5061 | TCP/UDP | Voice/Video telephony. 5060 (unencrypted) vs 5061 (TLS/encrypted). |
| **FTP** | 20, 21 | TCP | Port 21 (Control) vs Port 20 (Data). Attacked via sniffing or brute-force. |
| **Telnet** | 23 | TCP | **Unsecure.** Transmits data in cleartext. Used for banner grabbing. |
| **TFTP** | 69 | UDP | **Unreliable.** No auth; used for firmware updates. High risk for malware injection. |
| **BGP** | 179 | TCP | Used by ISPs for routing. Misconfig leads to BGP hijacking or flooding. |

---

## 5. SMTP Enumeration Commands

SMTP can be actively queried to verify existence of users or expand mailing lists.

| Command | Syntax | Purpose |
| :--- | :--- | :--- |
| **VRFY** | `VRFY <username>` | Confirms if a specific user account exists on the server. |
| **EXPN** | `EXPN <listname>` | Expands a mailing list name to show all individual member emails. |
| **RCPT TO** | `RCPT TO:<user@domain>` | Identifies valid recipients of a message during a mail transaction. |

---

## 6. Deep-Dive: High-Value Targets

### ÔøΩ TCP 139 & 445 (SMB)
- **TCP 139:** The legacy "NetBIOS Session Service". Used for **Null Sessions** (connecting without credentials) to extract user lists and shares.
- **TCP 445:** "Direct Host" SMB. Bypasses NetBIOS. Primary target for modern attacks (e.g., EternalBlue).

### üè∑Ô∏è SNMP (161/162)
- **Public/Private Strings:** Attackers guess common "community strings" (passwords) to walk the SNMP tree.
- **Vulnerability:** SNMP v1/v2 are unencrypted. **SNMP v3** is the only version with proper auth and encryption.

### üåê DNS (53)
- **Zone Transfers:** If `AXFR` query is allowed, an attacker gets the map of *every single host* in the organization.

---

## 7. CEH Exam Traps & Tips

| ‚ö†Ô∏è Common Trap | ‚úÖ Correct Understanding |
| :--- | :--- |
| **Is Enumeration Passive?** | **NO.** It is **ACTIVE**. You are touching the target. |
| **SMTP Command Confusion** | Remember `VRFY` = Verify, `EXPN` = Expand. `VRFY` is very common on the exam. |
| **SNMP Port Roles** | Port **161** = Requests to Agent; Port **162** = Traps (Notifications) to Manager. |
| **RPC Endpoint Mapper** | Targets port **135**. Vulnerable to malformed messages causing DoS. |
| **BGP Vulnerability** | BGP (Port 179) is vulnerable to hijacking and dictionary attacks. |
| **TFTP Security** | TFTP (Port 69) is connectionless and has **zero authentication**. |

---

*üìö CEH v13 ¬∑ Module 04: Enumeration | Last updated: February 2026*