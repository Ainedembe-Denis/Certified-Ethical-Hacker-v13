# üìü Techniques for NetBIOS Enumeration
### CEH v13 ¬∑ Module 04: Enumeration

> **About these notes:** A deep-dive into NetBIOS enumeration, a high-priority CEH topic. This guide covers the "how-to" of extracting user accounts, shared resources, and system details from legacy Windows environments.

---

## üìë Table of Contents

1. [What is NetBIOS and Why Enumerate It?](#1-what-is-netbios-and-why-enumerate-it)
   - [NetBIOS Names & Suffixes](#-netbios-names--suffixes)
   - [Key NetBIOS Ports](#-key-netbios-ports)
2. [The Nbtstat Utility](#2-the-nbtstat-utility)
   - [Nbtstat Parameters Table](#-nbtstat-parameters-table)
   - [Interpreting Output (Common Suffixes)](#-interpreting-output-common-suffixes)
3. [NetBIOS Enumeration Tools](#3-netbios-enumeration-tools)
4. [PsTools Suite: The Comprehensive Guide](#4-pstools-suite-the-comprehensive-guide)
5. [Enumerating Shared Resources (Net View)](#5-enumerating-shared-resources-net-view)
6. [AI-Powered NetBIOS Enumeration](#6-ai-powered-netbios-enumeration)
7. [CEH Exam Traps & Tips](#7-ceh-exam-traps--tips)

---

## 1. What is NetBIOS and Why Enumerate It?

NetBIOS (Network Basic Input/Output System) is an API used on older Windows networks to allow applications to communicate over a LAN. It is the legacy backbone for file and printer sharing.

> üí° **Analogy:** If modern protocols are cell phones, NetBIOS is an **old intercom system** in an office building. It's often still plugged in, broadcasting names and room numbers to anyone listening.

### üè∑Ô∏è NetBIOS Names & Suffixes
- **Structure:** A unique 16-character string. 15 characters are for the device name, and the **16th character** is reserved for the service or record type.
- **Important Note:** Microsoft does **not** support NetBIOS name resolution for **IPv6**.

### üîå Key NetBIOS Ports (NetBT)
| Port | Protocol | Service | Description |
| :-- | :--- | :--- | :--- |
| **137** | UDP | **NBNS / Name Svc** | Resolves NetBIOS names to IP addresses (the "phonebook"). |
| **138** | UDP | **Datagram Svc** | Handles connectionless communication (broadcasts). |
| **139** | TCP | **Session Svc** | Connection-oriented; where SMB file/printer sharing occurs. |

---

## 2. The Nbtstat Utility

`nbtstat` is the built-in Windows command for troubleshooting NetBIOS. It helps attackers enumerate protocol statistics and name tables.

### üîß Nbtstat Parameters Table
| Parameter | Function | Attacker's Use Case |
| :--- | :--- | :--- |
| **-a <name>** | List name table by hostname | Verify a victim's services if you know their computer name. |
| **-A <IP>** | List name table by IP address | **Most Useful.** Reverse lookup services/users from a target IP. |
| **-c** | List NetBIOS name cache | See which other systems the target has talked to recently. |
| **-n** | List local NetBIOS names | Check which services your own foothold machine is advertising. |
| **-r** | Display name resolution stats | Understand how the target resolves names (Broadcast vs WINS). |
| **-s / -S** | List current sessions | See who is currently connected (Client IP vs Workstation Name). |

### üîç Interpreting Output (Common Suffixes)
When running `nbtstat -A`, the 16th character (hex suffix) identifies the service:
- **<00> UNIQUE:** Workstation Service (The host's name).
- **<20> UNIQUE:** Server Service (**Goldmine:** indicates file sharing is enabled).
- **<03> UNIQUE:** Messenger Service (**Useful:** often reveals the logged-in username).
- **<1E> GROUP:** NetBIOS name of the domain or workgroup.

---

## 3. NetBIOS Enumeration Tools

| Tool | Capability |
| :--- | :--- |
| **Nmap (nbstat.nse)** | `nmap -sV -v --script nbstat.nse <target>` ‚Äî Retrieves name table and MAC address. |
| **NetBIOS Enumerator** | GUI tool pulling usernames, domain names, and MACs for entire IP ranges. |
| **Advanced IP Scanner** | Fast network scanner that lists IP, MAC, and NetBIOS info. |
| **Hyena / Nsauditor** | Management toolkits used to dump shares, sessions, and security logs. |

---

## 4. PsTools Suite: The Comprehensive Guide

The **PsTools** suite (Sysinternals) allows attackers to manage and control remote systems from the command line without installing client software.

| Tool | Primary Purpose | Attack Vector / Use Case | Sample Command |
| :--- | :--- | :--- | :--- |
| **PsExec** | Remote Execution | Launch interactive command prompts on remote systems. | `psexec \\<IP> -u <user> -p <pass> cmd` |
| **PsLoggedOn** | Find Logged-In Users | Identify machines where a **Domain Admin** is currently active. | `psloggedon \\<IP>` |
| **PsGetSid** | SID Translation | Map SIDs to user names and vice versa (Admin = RID 500). | `psgetsid \\<IP> <account>` |
| **PsInfo** | System Recon | Gather OS version, installation date, RAM, and CPU type. | `psinfo \\<IP>` |
| **PsFile** | List Remote Files | View (and close) files opened remotely on a system. | `psfile \\<IP>` |
| **PsList** | Resource Stats | View CPU, memory, and thread statistics for remote processes. | `pslist \\<IP>` |
| **PsKill** | Terminate Processes | Remotely kill antivirus, EDR, or security monitoring tools. | `pskill \\<IP> <process_id>` |
| **PsLogList** | Dump Event Logs | Remote elogdump; reveals logins, errors, and security events. | `psloglist \\<IP> system` |
| **PsPasswd** | Change Passwords | Perform mass password changes across managed systems via APIs. | `pspasswd \\<IP> <user> <new_pass>` |
| **PsShutdown** | Remote Control | Trigger a shutdown or reboot to perform a Denial-of-Service (DoS). | `psshutdown \\<IP> -s` |

---

## 5. Enumerating Shared Resources (Net View)

The `net view` command is a classic method for enumerating network topography.

- `net view \\<IP>` : Lists visible file and printer shares.
- `net view \\<IP> /ALL` : **The Attacker's Choice.** Shows all shares, including **hidden administrative shares** (ends with `$`, like `C$`, `ADMIN$`).
- `net view /domain` : Lists all domains/workgroups on the network.
- `net view /domain:<name>` : Lists all computer names within a specific domain.

---

## 6. AI-Powered NetBIOS Enumeration

Attackers leverage LLMs (AI) to automate and refine their command syntax.

- **Prompt:** *"Perform NetBIOS enumeration on 10.10.1.11"* ‚Üí **Result:** `nbtscan 10.10.1.11`
- **Prompt:** *"Get NetBIOS info with nmblookup"* ‚Üí **Result:** `nmblookup -A 10.10.1.11`
- **Prompt:** *"Enumerate NetBIOS on 10.1.1.22 using nmap"* ‚Üí **Result:** `nmap -sU -p 137 --script nbstat.nse 10.1.1.22`

---

## 7. CEH Exam Traps & Tips

| ‚ö†Ô∏è Common Trap | ‚úÖ Correct Understanding |
| :--- | :--- |
| **IPv6 Compatibility** | NetBIOS name resolution is **NOT supported** for IPv6. |
| **Ports & Protocols** | **137 (UDP)** = Names; **138 (UDP)** = Datagram; **139 (TCP)** = Session. |
| **The <03> Suffix** | Use it to identify the **logged-in user's name** on a target machine. |
| **PsExec vs Telnet** | PsExec is a "lightweight Telnet replacement"‚Äîno client install needed. |
| **Net View /ALL** | Crucial switch to reveal **hidden admin shares** (e.g., `IPC$`, `ADMIN$`). |

---

*üìö CEH v13 ¬∑ Module 04: Enumeration | Last updated: February 2026*